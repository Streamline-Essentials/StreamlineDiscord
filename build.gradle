plugins {
    id("java")
    id("net.kyori.blossom") version "1.3.1"
    id("com.github.johnrengelman.shadow") version "7.1.2"
}

apply plugin: 'java'
apply plugin: 'com.github.johnrengelman.shadow'
apply plugin: 'net.kyori.blossom'

group 'com.github.streamline-essentials'
version '1.13.4'

repositories {
    mavenCentral()
    maven { url = 'https://oss.sonatype.org/content/repositories/snapshots' }
    maven { url = 'https://oss.sonatype.org/content/repositories/central' }
    maven { url = 'https://jitpack.io' }
    maven { url = 'https://mvn.pkg.github.com' }

    maven {
        url = 'https://hub.spigotmc.org/nexus/content/repositories/snapshots/'

        // As of Gradle 5.1, you can limit this to only those
        // dependencies you expect from it
        content {
            includeGroup 'org.bukkit'
            includeGroup 'org.spigotmc'
        }
    }
}

dependencies {
    compileOnly 'org.spigotmc:spigot-api:1.20.1-R0.1-SNAPSHOT'

    compileOnly "net.luckperms:api:5.4"

    compileOnly("com.github.Streamline-Essentials.StreamlineCore:StreamlineCore-API:main-SNAPSHOT")
    annotationProcessor("com.github.Streamline-Essentials.StreamlineCore:StreamlineCore-API:main-SNAPSHOT")

    shadow("net.dv8tion:JDA:5.0.0-beta.12").exclude(group: "org.slf4j")
    implementation("net.dv8tion:JDA:5.0.0-beta.12").exclude(group: "org.slf4j")

    compileOnly("com.github.Streamline-Essentials:StreamlineMessaging:master-SNAPSHOT")
    compileOnly("com.github.Streamline-Essentials:StreamlineGroups:main-SNAPSHOT")
}

java {
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}

shadowJar {
    manifest {
        attributes 'Plugin-Class': 'tv.quaint.DiscordModule'
        attributes 'Plugin-Id': 'streamline-discord'
        attributes 'Plugin-Version': version
        attributes 'Plugin-Requires': ''
        attributes 'Plugin-Dependencies': 'streamline-messaging?, streamline-groups?'
        attributes 'Plugin-Description': 'Discord Module for StreamlineCore.'
        attributes 'Plugin-Provider': 'Quaint'
        attributes 'Plugin-License': 'Apache License 2.0'
    }

//    archiveFileName = "$archiveBaseName-$archiveVersion.$archiveExtension"
    archiveName = "$baseName-$version.$extension"
}

artifacts {
    archives shadowJar
}